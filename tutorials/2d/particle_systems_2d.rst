.. _doc_particle_systems_2d:

Системы частиц (2D)
=====================

Введение
--------

В поставке идет простая (но достаточно гибкую для большинства применений) 
система частиц. Частицы используют для симуляции комплексных физических
эффектов таких как искры, огонь, волшебная пыль, дым, mist, и т.п.

Идея в том что "частица" испускаются за определенный промежуток времени
с заданной продолжительностью жизни. Во время жизни, каждая частица обладает 
одинаковым базовым поведением. Каждую частицу делает уникальной и обеспечивает
более органичный вид - "случайность" ассоциированная с каждым параметром. 
В сущности, создание системы частиц означает установку базовых физических
параметров и затем добавление им случайности.

Particles2D
~~~~~~~~~~~

Системы частиц добавляются в сцену узлом
:ref:`Particles2D <class_Particles2D>`. Они включены по-умолчанию
И запускают эмиссию частиц в виде падающих белых точек (под действием гравитации).
Это разумная отправная точка для последующих настроек тоак как вам надо.

.. image:: /img/particles1.png

Текстура
~~~~~~~~

Системы частиц используют одну текстуру (в будущем это возможно будет
расширено анимацией через spritesheet). Текстуру задают через соответствующее свойство:

.. image:: /img/particles2.png

Физические переменные
---------------------

Перед тем как начать разговор о глобальных переменных для систем частиц,
давайте сначала посмотрим, что произойдет, когда физические параметры будут изменены.

Direction - направление
-----------------------

Это базовый угол направления эмиссии. По - умолчанию равен 0 (вниз):

.. image:: /img/paranim1.gif

Изменяя этот угол, изменяется направление эмиссии но гравитация
продолжит свое воздействие:

.. image:: /img/paranim2.gif

Этот параметр полезен потому что, вращая узел, гравитация тоже будет вращаться.
Изменение направления держит их отдельно.

Spread-распространение
----------------------

Spread это угол в пределах которого частицы будут случайно испускаться.
Увеличение spread увеличивает этот угол. Spread равное 180 будет испускать
частицы во всех направлениях.

.. image:: /img/paranim3.gif

Линейная скорость
-----------------

Linear velocity это скорость с которой испускаются частицы (в
пикселей в секунду). Скорость впоследствии может изменяться 
гравитацией или accelerations (как описано ниже).

.. image:: /img/paranim4.gif

Скорость вращения
-----------------

Spin velocity это скорость с которой частицы вращаются вокруг своего центра
(в градусах/чекунду).

.. image:: /img/paranim5.gif

Орбитальная скорость
--------------------

Orbit velocity используется для того, чтобы частицы вращались вокруг их центра.

.. image:: /img/paranim6.gif

Направление и сила гравитации
-----------------------------

Gravity имеет направление и силу. Гравитация применяется к каждой
живущей на данный момент частице.

.. image:: /img/paranim7.gif

Радиальное ускорение
--------------------

Если это ускорение положительное, частицы ускоряются от их центра. 
Если отрицательное, они поглощаются ею.

.. image:: /img/paranim8.gif

Тангенциальное ускорение
------------------------

Это ускорение использует tangent vector к центру. Совместно с
radial acceleration может давать хороший эффект.

.. image:: /img/paranim9.gif

Damping-демпфирование
---------------------

Damping применяет трение к частицам, заставляя их останавливаться. Это
особенно полезно для искр и взрывов, которые обычно имеют высокую
линейную скоростьy и затем останавливаются по мере падения.

.. image:: /img/paranim10.gif

Начальный угол
--------------

Задает начальный угол частиц (в градусах). Этот параметр
в основном полезно рандомизировать.

.. image:: /img/paranim11.gif

Начальный и финальный размер
----------------------------

Определяет начальный и финальный масштаб частиц.

.. image:: /img/paranim12.gif

Цвет фазы
---------

Частицы могут иметь до 4 цветовых фаз. Каждая фаза цвета может включать
прозрачность.

Фазы должны обеспечивать смещение значений в пределах от 0 дo 1, и всегда
по возрастанию. Например, цвет в начале будет со смещением 0 а в конце
- 1, но 4 цвета могут иметь различные смещения, такие как 0, 0.2,
0.8 1.0 для разных фаз:

.. image:: /img/particlecolorphases.png

В результате:

.. image:: /img/paranim13.gif

Глобальные параметры
--------------------

Эти параметры влияют на поведение всей системы.

Время жизни
-----------

Время в секундах, в течение которого каждая частица останется в живых. 
Когда срок жизни Заканчивается, пораждается новая частица ей на смену.

Lifetime: 0.5

.. image:: /img/paranim14.gif

Lifetime: 4.0

.. image:: /img/paranim15.gif

Timescale
---------

Часто эффект выглядит как надо, но слишком медленно или быстро.
Timescale помогает подстроить среднюю скорость.

Timescale everything 2x:

.. image:: /img/paranim16.gif

Preprocess
----------

Системы частиц стартуют с 0 испускаемых частиц, затем эмиссия начинается.
Это может быть неудобством, когда вы просто загружаете сцену и системы типа факела,
begin emitting the moment you enter. Preprocess используется чтобы дать системе
обработать какоето количество секунд прежде чем действительно появиться.

Emit timeout
------------

Эта переменная отключает эмиссию после заданного количества секунд. Если ноль, то оно отключено.

Offset
------

Позволяет переместить центр эмиссии от центра

Half extents
------------

Расширяет центр эмиссии (по-умолчанию 1 pixel), до заданного размера в пикселях. 
Частицы будут испускаться случайно в заданной области.

.. image:: /img/paranim17.gif

Также можно установить маску эмиссии, используя это значение. В меню
"Particles" во вьюпорте редактора 2D сцены выделите нужную текстуру.
Непрозрачные пиксели будут использоваться как потенциальные точки эмиссии,
а прозрачные будут проигнорированы:

.. image:: /img/paranim19.gif

Local space
-----------

Эта опция включена по-умолчанию, и это означает, что пространство, в котором находятся частицы
и испускаются - находится внутри узла. Если узел переместить, все частицы переместяться с ним:

.. image:: /img/paranim20.gif

Если disabled, будут испускаться в глобальном пространстве, что означает что если
узел перемещается, the emissor is moved too:

.. image:: /img/paranim21.gif

Explosiveness
-------------

Если lifetime равно 1 и есть 10 частиц, это значит что каждая частица
будет испускаться за 0.1 секунду. Параметр explosiveness изменяет это,
заставляет частицы испускаться разом. Диапазоны:

-  0: Испускаются все частицы вместе.
-  1: Испускать частицы с равным интервалом.

Допускаются промежуточные значения. Эта функция полезна для создания
взрывов или внезапных всплесков частиц:

.. image:: /img/paranim18.gif

Randomness
----------

Все физические параметры могут быть рандомизированы. Случайные переменные
от 0 до 1. формула для рандомизации параметра :

::

    initial_value = param_value + param_value*randomness
