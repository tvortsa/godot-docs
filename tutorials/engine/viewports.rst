ть .. _doc_viewports:

Вьюпорты
=========

Введение
------------

В Godot небольшая но очень полезная функция - вьюпорты. Вьюпорты
как подразумевает название, прямоугольники в которых отрисовывается мир.
Они имеют три основных назначения, но могут гибко адаптироваться к гораздо большему. 
Все это делают через узел :ref:`Viewport <class_Viewport>`.

.. image:: /img/viewportnode.png

Основными видами использования являются:

-  **Scene Root**: root активной сцены всегда Viewport.
   Это то, что отображает сцены, созданные пользователем. (Вы должны 
   уже знать об этом из предыдущих уроков!)
-  **Sub-Viewports**: Могут быть созданы когда Viewport является потомком
   :ref:`Control <class_Control>`.
-  **Render Targets**: Вьюпорты могут быть установлены в "RenderTarget" режиме.
   это значит что видовое окно невидимо напрямую, но к его содержимому
   можно обратиться через :ref:`Texture <class_Texture>`.

Ввод
-----

Вьюпорты Также отвечают за доставку должным образом скорректированных и
масштабированных событий ввода ко всем его дочерним узлам. И root viewport
и sub-viewports делают это автоматически, но render targets нет.
Поэтому, пользователи должны делать это вручную через функцию
:ref:`Viewport.input() <class_Viewport_input>` если нужно.

Слушатель
--------

Godot поддерживает 3D звук (и в 2D и в 3D узлах), больше об этом
мы узнаем в следующих уроках (one day..). Чтобы слышать такой тип звука,
вьюпорт должен быть включен как слушатель (для 2D или 3D).
Если вы используете custom viewport для отображения вашего мира, не забудьте
включить это!

Камеры (2D и 3D)
-----------------

При использовании 2D или 3D :ref:`Camera <class_Camera>` /
:ref:`Camera2D <class_Camera2D>`, камеры всегда отображают ближайший
родительский вьюпорт (восходящий к root). Например, в след. иерархии:

-  Viewport

   -  Camera

Камера отобразится в родительском видовом экране, но в следующем:

-  Camera

   -  Viewport

Нет (или может отображаться в корневом окне просмотра, если это под-сцена).

В окне просмотра может быть только одна активная камера, так что,
если их больше чем одна, убедитесь что у желаемой камеры активировано
свойство "current" или сделать камеру текущей вызовом:

::

    camera.make_current()

Масштаб и растяжение
------------------

У вьюпортов есть свойства "rect". X и Y часто не используют (только
root вьюпорт реально их использует), а WIDTH и HEIGHT представляют
размер вьюпорта в пикселях. Для Sub-Viewports, эти значения
перекрываются тем что установлено в parent control, но для render targets
это задает их разрешение.

2D содержимое также можно масштабировать and make it believe the
viewport resolution отличающееся от указанного в rect, 
вызовом:

::

    viewport.set_size_override(w,h) #кастомный размер для 2D
    viewport.set_size_override_stretch(true/false) #enable stretch для кастомного размера

Root вьюпорт использует это для параметров растяжения в настройках проекта.

Миры
------

Для 3D, вьюпорт будет содержать :ref:`World <class_World>`. 
Это базовая вселенная которая связывает физику и рендер.
Spatial-base узлы регистрируют с помощью World ближайшего вьюпорта.
По умолчанию, вновь созданные вьпорты не содержат World но
используют тот же что и родительский вьюпорт (root вьюпорт содержит
хотябы один, который является объектом который рендерится по-умолчанию). 
Мир может быть установлен во вьюпорт опцией "world", это отделяет
все дочерние узлы этого вьюпорта от взаимодействия с миром родительского
вьюпорта. Это особенно удобно например, когда вам нужно показать 
отдельного персонажа в 3D наложенного поверх игры (как в Starcraft).

Чтобы помочь в ситуациях где вы хотите создать вьюпорты которые отображают
одиночные объекты и не хотчт создавать мир, вьюпорт имеет опцию использовать
свой собственный мир (World). Это очень пригодиться когда вы хотите
инстанцировать 3D персонаж или объект в 2D мире.

Для 2D, каждый Viewport всегда содержит свои собственные :ref:`World
